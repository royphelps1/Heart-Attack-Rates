# DSCI-511 Project – Heart Attack Risk in China

## Phase 1 Dataset & Documentation

This repository contains the project work for **DSCI-511: Data Acquisition and Pre-Processing**.  
Phase 1 focused on scoping, cleaning, and enriching a heart-attack dataset related to China.

### Phase 1 Inputs:
- **Dataset:** `data/raw/heart_attack_china.csv`
- **Data Dictionary:** `docs/data_dictionary.md`
- **Normalized Variables Plan:** `docs/normalized_flags.md`
- **Phase 1 Report Scaffold:** `docs/Phase1_Report_Scaffold.md`

### Phase 1 Output:
- `data/processed/heart_attack_china_enriched.csv`

### Phase 1 Work Includes:
- Initial data cleaning and normalization
- Creating derived flags (e.g., SBP missing, hypertension thresholds)
- Standardizing gender categories
- Building baseline cardiovascular risk attributes
- File-level documentation and schematics

---

## Phase 2 – WHO Integration, Merging, and Spatial Analysis

Phase 2 extended the dataset through World Health Organization (WHO) indicators and geospatial context to enable **province-level analysis**.

### Key Phase 2 Inputs:
- Phase 1 enriched dataset:
  - `data/processed/heart_attack_china_enriched.csv`
- WHO indicators (mean SBP by province and sex)
- China boundary dataset (Kaggle / GADM):
  - `data/external/gadm36_CHN_1.json`

### Custom Dataset Built in Phase 2:
- `data/processed/urban_or_rural_centroids.geojson`

This dataset was programmatically created and includes:
- Province name
- Urban vs Rural classification
- Longitude / Latitude centroids

Centroids generated from:
- Wikipedia province and capital data
- OpenStreetMap geocoding via OSMnx

---

## Main Notebook

**Phase 2 Implementation Notebook:**
notebooks/phase2_all_in_notebook.ipynb

This notebook performs:

- WHO dataset cleaning and latest-year selection
- Integration of WHO indicators into the heart-attack dataset
- Creation of versioned datasets:
  - `heart_attack_china_analysis_ready.csv`
  - `heart_attack_china_model_ready.csv`
  - `heart_attack_china_with_who_latest_by_sex.csv`
- Aggregation from patient-level → province-level metrics:
  - `heart_attack_rate`
  - `mean_sbp`
  - `mean_cvd_risk`
- Construction of GeoDataFrames via GeoPandas
- Choropleth maps of:
  - Heart attack rate by province
  - Mean systolic blood pressure by province
- Visualization overlays using **contextily** (OpenStreetMap)
- Urban/rural centroid visualization with province labeling
- Reproducible GeoJSON workflows

---

## Figures and Maps

All maps and figures generated by the notebook are saved locally to:

reports/figures/


Examples:
- `heart_attack_rate_by_province.png`
- `mean_sbp_by_province.png`
- `heart_attack_rate_with_basemap.png`
- `mean_sbp_with_basemap.png`
- `urban_rural_centroids_with_labels.png`

> These are intentionally not tracked in Git to avoid file size limits and because they are reproducible.

---

## Large File Handling

A large patient-level GeoJSON file may be generated:

data/processed/china_heart_attack_analysis.geojson (~760MB)

notebooks/phase2_all_in_notebook.ipynb

2. Run the notebook from top to bottom.
3. Outputs will be written automatically to:

---

## Team

**DSCI-511 Project Team:**
- Evan Wessel  
- Leland Weeks  
- Shad Scarboro  
- Roy Phelps  

---

## Project Resources

- **Google Drive (large files & collaboration):**  
https://drive.google.com/drive/folders/1vawtjJAgRlAttClKjX46eAY9A2p-jNFe?usp=share_link

- **GitHub Repository:**  
https://github.com/royphelps1/DSCI-511-Project

---

## Repo Structure

```text
.
├── notebooks/           # Jupyter notebooks (Phase 1 & 2 pipelines)
├── src/                 # Reusable Python modules
├── tests/               # Optional unit tests
├── data/
│   ├── raw/             # Original datasets
│   ├── processed/       # Analysis-ready data
│   └── external/        # Geographic reference data
├── reports/
│   ├── paper/           # Final write-up or LaTeX paper
│   ├── figures/         # Plots/maps (generated locally)
│   └── tables/          # Exported tables
├── docs/                # Documentation & scaffolds
├── references/          # Citation and reference materials
├── environment.yml      # Optional Conda environment
├── CONTRIBUTING.md      # Team workflow
└── .gitignore

